\documentclass[Afour,sageh,times]{sagej}
\usepackage[utf8]{inputenc}
\usepackage[USenglish]{babel}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{csquotes}
\usepackage{url}
\usepackage{moreverb}
\usepackage[colorlinks,bookmarksopen,bookmarksnumbered,citecolor=red,urlcolor=red]{hyperref}
\newcommand\BibTeX{{\rmfamily B\kern-.05em \textsc{i\kern-.025em b}\kern-.08em T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}


\def\volumeyear{\the\year}




\begin{document}

\runninghead{Author Redacted}
\title{The Importance of Being Nonplanar: Street Network Representation in Urban Form Studies}
\author{Author Redacted \affilnum{1}}
\affiliation{\affilnum{1}Affiliation redacted}
\corrauth{Author Redacted, Address Redacted}
\email{Email Redacted}


\begin{abstract}

\end{abstract}

\keywords{street network, GIS, urban form, transportation, urban design}

\maketitle

\section{Introduction}

In urban planning and urban design research, street networks are routinely used to calculate accessibility between origins and destinations or to compute indicators of the urban form, such as block sizes or intersection density and connectivity.

This article presents two new measures of the degree of nonplanarity for urban street networks that can be generalized to any spatial network. It compares the results and interpretation of these nonplanarity indicators to the formal, mathematical planarity of street networks around the world. Despite common claims in the literature that street networks are planar graphs, this study finds that they generally are not and that planar graphs poorly model the street networks of many cities. Further, the magnitude of this bias varies substantially across cities and urbanization types.

This article is organized as follows. The following section introduces the relevant basics of graph theory urban studies, focusing on discussions in the research literature about street network planarity. The next section introduces the methods used to acquire and analyze the street networks in this study. Then this article presents the results of this analysis before concluding with a discussion of their ramifications for street network research and urban form studies.


\section{Background}

First, a few definitions are in order. Graph theory is the mathematical study of networks \citep{newman_networks:_2010}. Graphs can mathematically model real-world networks such as friendships or the Internet as well as spatial networks, such urban street networks \citep{barthelemy_spatial_2011}. A graph $G$ consists of a set of nodes $N$ connected to one another by a set of edges $E$. An edge $uv$ in a directed graph points in one direction from some node $u$ to some node $v$, but an undirected graph's edges all mutually point in both directions. How a graph's nodes and edges connect to one another defines its topology. For example, a node's degree is a topological trait that represents how many edges connect to that node. A planar graph can be drawn on a two-dimensional plane without any of its edges crossing each other, except where they intersect at nodes. If the graph \emph{cannot} be drawn or redrawn to meet this criterion, then the graph is nonplanar \citep{trudeau_introduction_1994}. Street networks are embedded in space, which provides them with geometry --- such as geographical coordinates, lengths, and area --- alongside their topology.

\begin{table*}[htbp]
\centering
\caption{Recent statements in the urban studies and urban physics literatures regarding the representation of street networks as planar graphs.}
\label{tab:planar_quotes}
\input{table_planar_quotes.tex}
\end{table*}

This creates a minor wrinkle when we consider planarity: we must distinguish between a graph's topological planarity, which we shall refer to as \emph{formal planarity}, and the planarity of its particular spatial embedding, which we shall refer to as \emph{spatial planarity}. A street network might be spatially nonplanar due to its embedding in space (i.e., it contains overpasses or underpasses in the real-world), but it could still be formally planar. For example, if we \enquote{redraw} the graph by moving its nodes and edges around in space without changing how they are connected to one another (i.e., altering its geometry without altering its topology), there may exist some spatial embedding that prevents edges crossing anywhere but nodes \citep[for a more comprehensive discussion see][pp.~6--10]{barthelemy_morphogenesis_2017}. In such a case, the street network is formally planar from a topological perspective, but its real-world embedding is spatially nonplanar.

Consider two theoretical examples: a medieval European city center and a modern American city center. The former's circulation network comprises a set of pedestrian paths and drivable streets without any grade separation, overpasses, or underpasses. In two-dimensions, its edges (i.e., streets and paths) cross each other only at nodes (i.e., intersections), so it is by definition planar. The latter's circulation network comprises pedestrian paths, drivable surface streets, and a grade-separated freeway with overpasses over some of the surface streets. In two-dimensions, its edges occasionally cross each other at non-nodes (i.e., overpasses), so it is by definition nonplanar. However, we might call it \emph{approximately} planar because its nonplanar edge crossings are relatively uncommon. Approximate planarity constrains this nonplanar spatial network such that it does not exhibit certain characteristics found among nonplanar aspatial graphs (e.g., small-world effects or power-law distributed node degrees).

In the urban studies and urban physics literature, street networks are commonly referred to as planar graphs. Table \ref{tab:planar_quotes} presents a survey of statements and reasoning around this claim. Some authors prefer to hedge slightly, arguing that street networks are \emph{approximately} or \emph{essentially} planar graphs that are close enough to be well-modeled as such.

If street networks can be sufficiently well-modeled by planar graphs, there are certain methodological benefits to doing so. Planar graphs offer computational simplicity and tractability. They enable easy polygonal spatial analysis of city blocks and form \citep{fohl_non-planar_1996} as well as the Euler characteristic. In mathematics, there is a bijection between planar graphs and trees, and classifying planar graphs presents a trivial problem \citep{louf_typology_2014}. Planar graphs are easier to visualize and can be faster to run algorithms on \citep{liebers_planarizing_2001}. Accordingly, \citet[p.~3]{barthelemy_spatial_2011} argues that \enquote{planar spatial networks are the most important and most studies have focused on these examples}. But in contrast, \citet{masucci_random_2009} and \citet{masucci_limited_2013} argue that planar graphs remain a compelling research domain for urban scholars because they were understudied until recently for two reasons: they appear topologically trivial and planarity does not lend itself to certain popular graph-theoretic analyses. Discussing the open research area around street networks as planar graphs, \citet[p.~1]{viana_simplicity_2013} state, \enquote{there is still a lack of global, high-level metrics allowing to characterize their structure and geometrical patterns.}

Despite the computational and mathematical advantages of simple planar models, street networks are often nonplanar in reality: many include at least one overpass or underpass that results in the failure of formal proofs of their planarity, such as the \citet{kuratowski_sur_1930} theorem or the \cite{hopcroft_efficient_1974} algorithm \citep[cf.][]{gastner_spatial_2006}. As \citet[p.~7]{levinson_network_2012} points out, \enquote{Real networks are neither perfect, nor planar, nor grids, though they may approximate them.}

Other authors have commented on this characteristic of street networks. \citet[p.~199]{jiang_object-oriented_2010} explain that \enquote{Quite often the transportation network has overpasses and underpasses that require a non-planar network representation.} \citet[p.~1258]{fischer_spatial_2014} explains that \enquote{For many infrastructure networks, {[planarity]} is approximately true, although bridges and tunnels in ground-transport networks are an obvious (but generally minor) exception.} Twenty years ago, \citep[p.~18]{fohl_non-planar_1996} claimed, \enquote{The most commonly used data model for transportation networks is the fully intersected, planar data model} and called for a nonplanar model to better represent truly nonplanar spatial networks. \enquote{The planar network data model has received widespread acceptance and use. Despite its popularity, the model has limitations for some areas of transportation analysis, especially where complex network structures are involved. One major problem is caused by the planar embedding requirement... intersections at grade cannot be distinguished from intersections with an overpass or underpass that do not cross at grade.} \citep[p.~395]{fischer_gis_2004} 

If a planar graph models a street network poorly, it could do so in multiple ways. Forcing planarity on a nonplanar street network creates artificial nodes at bridges and tunnels, which breaks routing. As \citet[p.~6]{kwan_review_1996} puts it, \enquote{the difficulty in accurately representing overpasses or underpasses may lead to problems when running various routing algorithms (e.g. recommending that a traveler make a left-turn at an intersection that proves to be an overpass)}. Second, and accordingly, intersection counts and density will be overestimated. Similarly, edge lengths will be underestimated due to these artificial breakpoints. Finally, this bias would likely behave inconsistently across different kinds of cities and street network types.

Given these issues, what do \emph{approximately planar} and \emph{well-modeled} mean for street networks? How close is close enough for a planar graph to competently model a mathematically nonplanar street network? Do the biases of planar models remain consistent across geographies or do they misrepresent different places to different degrees? If street networks are in general approximately planar, then how can we measure how planar or nonplanar a given street network is?

The graph theory literature offers some measures of how \enquote{far off} a nonplanar graph $G$ is from being planar, such as its crossing number --- the minimum number of edge crossings of any drawing of $G$ --- and the skewness --- the minimum number of edges that must be removed from $G$ to produce a planar graph \citep{liebers_planarizing_2001,szekely_successful_2004,chimani_non-planar_2009}. However, these measures are imperfect and hard to compute \citep{chimani_vertex_2012,szekely_successful_2004}. In his discussion of road networks and approximate spatial planarity, \citet[p.~133]{newman_networks:_2010} argues that \enquote{no widely accepted metric for degree of planarity has emerged,} and calls for the development of better indicators.

Such metrics would be particularly useful for street networks, as the extent to which a network is (or is not) planar can characterize the nature of its circulation infrastructure and urban form. For instance, late 20th-century American cities might exhibit lower planarity than older European cities.

In this study, we present two new measures of the extent to which a spatial network is planar. We then analyze various world cities to better understand how well planar graphs model their street networks as well as the extent to which bias (i.e., model misrepresentation) varies across different places or types of urbanization. Finally, we consider what these indicators suggest about the nature of the urban form in different cities.



\section{Methods}

\subsection{Data}

We analyze the drivable and the walkable street networks in the centers of 50 cities worldwide. Following \citet{jacobs_great_1995} and \citet{cardillo_structural_2006}, we analyze a consistently sized, square-mile network at the centers of each of these cities.

OSMnx and how the networks are processed. walk vs drive.

\subsection{Analysis}

Once we have acquired and prepared our networks, we calculate three indicators of nonplanarity. The first indicator, SPS, represents the ratio of nonplanar intersections (i.e., non-dead-end nodes in the nonplanar, spatially-embedded graph) to planar intersections (i.e., line crossings in the planar, spatially-embedded graph). It indicates the extent to which planarity overstates intersections and connectivity in each street network. A truly planar street network with no bridges or tunnels will thus have a SPS score of 1.0, while lower values suggest the extent to which the network is nonplanar.

The second indicator, ELR, represents the ratio of the mean edge length in the planar graph to the mean edge length in the nonplanar graph. It indicates the extent to which planarity understates edge lengths (a linear proxy for block size) in each street network. A truly planar street network with no bridges or tunnels will thus have a ELR score of 1.0, while lower values suggest the extent to which the network is nonplanar.

The third indicator is a formal test of aspatial planarity using the algorithm described by \citet{boyer_subgraph_2012}. A graph is mathematically planar if it can be drawn on a two-dimensional surface with edges crossing only at nodes \citep{trudeau_introduction_1994}. Although a street network may be spatially nonplanar due to overpasses or underpasses, this may be a feature of its configuration in space. That is, is it possible to rearrange the nodes and edges in space --- while preserving the graph's topology --- so that edges cross only at nodes? This indicator tells us if the graph is formally planar, ignoring its real-world spatial embedding.

Finally, we examine a single city more deeply to better understand how these indicators vary across a single municipality. For this, we analyze the drivable street network of Oakland, California, a reasonably representative midsized American city with a variety of urban form types, from gridded street patterns in its flatlands, to winding culs-de-sac in its hills, to freeways and dense blocks around its downtown. We first analyze the entire city of Oakland and then recreate the aforementioned methodology by sampling 100 random points within the city limits and analyzing a square-mile street network centered on each point. This demonstrates the statistical dispersion of the planarity indicators across a single city and the extent to which agglomerating an entire city's neighborhoods into a single graph may obscure neighborhood-scale effects.





\section{Results}

\subsection{Worldwide Cities}

\begin{figure*}[htbp]
    \center
    \includegraphics[width=\textwidth]{world_map_phi_bw.png}
    \caption{Map of world cities in Table \ref{tab:world_cities} grouped by SPS score tertiles.}
    \label{fig:world_map_bw}
\end{figure*}


\begin{table*}[htbp]
\centering
\caption{Indicators of nonplanarity for one square mile street networks at the centers of 50 cities worldwide. SPS = spatial planarity score = the ratio of nonplanar intersections to planar intersections. ELR = edge length ratio = the ratio of mean edge length in planar graph to mean edge length in nonplanar graph. Planar = whether street network passed a formal test of planarity.}
\label{tab:world_cities}
\input{table_world_cities.tex}
\end{table*}




\begin{figure*}[htbp]
    \center
    \includegraphics[width=0.5\textwidth]{regression_phi_split.png}
    \caption{Log-log plot of ELR vs SPS with simple regression lines: drive $r^2=0.98$ and walk $r^2=0.99$.}
    \label{fig:regression_split}
\end{figure*}


\subsection{A Deeper Look: Oakland, California}

We find that the street network of the entire city of Oakland is formally nonplanar when subjected to a formal mathematical test. In terms of the nonplanarity indicators, the city as a whole has a SPS score of 0.918, indicating that it is 91.8\% planar, and a ELR score of 0.936. This suggests that the planar representation of Oakland's drivable street network overstates the number of intersections (and thus, the network's connectivity) by 8.9\% city-wide (i.e., $1 / 0.918$ and understates the average edge length by 6.4\% city-wide. However, these indicators' values vary across the city.

To explore this statistical variation, we examined 100 square-mile samples of Oakland's drivable street network. Table \ref{tab:samples_city} presents descriptive statistics of these planarity indicators. 



\begin{table}[htbp]
\centering
\caption{Descriptive statistics of planarity indicators across 100 random square-mile sample runs in Oakland, California's drivable network.}
\label{tab:samples_city}
\input{table_samples_city.tex}
\end{table}






\section{Discussion}

Our findings suggest that most street networks in the centers of major cities are mathematically nonplanar but approximately planar. However, this depends on the scale of measurement: across an entire city there is likely to be some underpass or overpass somewhere, while individual neighborhoods or small suburbs might be formally planar. The type and era of urbanization is another factor. Old medieval European towns or informal settlements in the global south contain fewer grade-separated roads (and thus greater planarity) than 20th-century American or 21st-century Chinese metropolises do. This is a result of prevailing transportation technologies when the urban form was built up, as well as terrain, costs, wealth, culture, and politics.

Street networks are frequently nonplanar in the formal sense because they are spatially embedded in three dimensions --- not two --- and have a z-coordinate along with their x and y. Because they are mostly planar, typically with only a few overpasses or underpasses, they could often be described accurately as \emph{approximately planar}. However, claiming that urban street networks broadly are planar misrepresents them in several ways.

1. Forces false nodes where grade-separated edges cross.

2. Accordingly, underestimates average edge length (a proxy for street segment lengths and block sizes)

3. Misrepresents connectivity for routing, accessibility analysis, and other connectivity studies

Why are they approximately planar? Cost and politics. Expensive to build truly 3-D networks (with z-coordinates as extensive as their x- and y-coordinates) and politically infeasible.

Are street networks planar graphs? Contrary to some of the statements in the urban studies and urban physics literature, our results suggest that this cannot be universally claimed. But perhaps some of it comes down to vocabulary. If road is not synonymous with street, then a road network and a street network may not be synonymous. A road network, including freeways and boulevards, may frequently be nonplanar, but a street network, focusing on municipal streets lined by land parcels, may be at-grade and planar. But this ignores the fact that even residential streets sometimes include bridges and tunnels in hilly neighborhoods, and the fact that our analysis earlier showed that walkable circulation networks in city centers often include pedestrian tunnels and footbridges. A graph is not planar because its edges \emph{usually} or \emph{approximately} intersect only at nodes: it is planar because its edges \emph{exclusively} intersect at nodes.

Thus, street networks are not universally planar graphs. But as George Box famously stated, \enquote{All models are wrong but some are useful.} Can street networks generally be simplified to planar graphs and still be usefully well-modeled? Then answer depends on the place and on the type of analysis. In limited circumstances, where the circulation network and built form exhibit few underpasses, overpasses, or grade-separation, then perhaps yes. But universally, we must answer no.

Most egregiously, imposing planarity on a nonplanar street network forces pseudonodes at underpasses and overpasses, breaking routing and network-based accessibility modeling. For this reason, nonplanar graphs have been the standard for decades in transportation engineering, real-world traffic assignment models, and routing engines. But planar graphs are often used in the literature to study urban form and morphology. So, aside from routing, do planar graphs offer \emph{useful} models for this type of research? Again, only in limited circumstances, including examples such as the drivable networks in the three Italian cities we analyzed, which are formally planar. The results in Table \ref{tab:world_cities} show how common urban form measures such as intersection counts are overstated by planar models, while average edge lengths (a linear proxy for block size) is consequently understated. Moreover, this misrepresentation behaves inconsistently from place to place. Figure \ref{fig:world_map_bw} demonstrates how the magnitude of bias varies across cities and eras of urbanization.

So then why use planar graphs? Tractable. In some cities it doesn't matter (Italy). Polygonal analysis of urban blocks. Otherwise use nonplanar, new tools make it easy.


\section{Conclusion}

The urban studies and urban physics literatures frequently use planar graphs to urban street networks. This study demonstrated that although in limited circumstances these models may be accurate, they can behave inconsistently across different kinds of cities by misrepresenting connectivity, accessibility, routing, intersection counts and densities, and street segment lengths. It found x, y, and z. It also demonstrated how these indicators can be used to characterize the type of urbanization, in particular its three-dimensionality, of different cities. Future research can explore this latter finding, as it likely correlates with other measures of urbanization, development, and era. Finally, future research might examine how nonplanar intersection counts represent true intersections if multiple adjacent edges form multiple graph intersections at a point where only one true intersection exists from an urban design perspective.


\clearpage
\bibliographystyle{apa}
\bibliography{references}

\end{document}
